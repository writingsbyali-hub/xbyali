---
export interface LibraryArchiveItem {
  id: string;
  title: string;
  excerpt?: string;
  type?: string;
  tags: string[];
  dateLabel?: string;
  periodLabel?: string;
  link: string;
  gridSpan?: number;
  searchIndex: string;
}

export interface Props {
  item: LibraryArchiveItem;
}

const { item } = Astro.props;
const spanClass =
  item.gridSpan && item.gridSpan > 1 ? 'sm:col-span-2 xl:col-span-6' : 'sm:col-span-1 xl:col-span-4';
const tags = item.tags.filter(Boolean);
const dataTags = tags.map((tag) => tag.toLowerCase()).join('|');
const dataCategory = item.type?.toLowerCase() ?? '';
const dataSearch = item.searchIndex ?? '';
---

<article
  id={item.id}
  class={`library-card col-span-1 flex flex-col gap-5 rounded-3xl border border-neutral-200 bg-neutral-900 p-6 text-white shadow-[0_35px_60px_-40px_rgba(15,23,42,0.6)] transition duration-300 hover:-translate-y-1 hover:border-white dark:border-neutral-700 dark:bg-neutral-950 ${spanClass}`}
  data-library-item
  data-type="archive"
  data-status=""
  data-tags={dataTags}
  data-category={dataCategory}
  data-search={dataSearch}
>
  <div class="flex items-center justify-between text-xs font-semibold uppercase tracking-[0.35em] text-neutral-300">
    <span>{item.type ?? 'Archive'}</span>
    {item.periodLabel && <span class="rounded-full border border-neutral-600 px-3 py-1 text-[10px] tracking-[0.3em]">{item.periodLabel}</span>}
  </div>
  <div class="space-y-3">
    <h3 class="text-2xl font-semibold leading-tight text-white">
      <a class="block focus:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-4 focus-visible:ring-offset-neutral-900" href={item.link}>
        {item.title}
      </a>
    </h3>
    {item.excerpt && <p class="text-sm leading-relaxed text-neutral-200">{item.excerpt}</p>}
  </div>
  {tags.length > 0 && (
    <div class="mt-auto flex flex-wrap gap-2">
      {tags.map((tag) => (
        <button
          type="button"
          class="js-filter-tag inline-flex items-center rounded-full border border-white/30 px-3 py-1 text-xs font-semibold uppercase tracking-[0.28em] text-white transition hover:border-white hover:bg-white hover:text-neutral-900"
          data-tag={tag.toLowerCase()}
        >
          {tag}
        </button>
      ))}
    </div>
  )}
  <a class="sr-only" href={item.link}>
    View archive entry {item.title}
  </a>
</article>
